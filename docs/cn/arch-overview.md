| id            | 标题     |
| ------------- | -------- |
| arch-overview | Overview |

本文档提供了Zilliqa区块链设计和架构的高阶概述。由于其架构代表了其与第一代比特币和以太坊衍生品的显着区别，因此将它们用作类比是没有意义的。



# 结构与共识

Zilliqa网络由一个DS委员会（一种特殊类型的分片）和`n`个普通分片组成。每个分片都有许多节点，其中一个节点是`领导者`，`k`个备份。

从广义上讲，每个分片都运行一个称为现实拜占庭容错（pBFT）的算法，以便在任何时候就区块链的状态达成共识。粗略概述如下：

1. 预备：`领导者`在分片中向备份节点宣布区块链状态作为预备消息。
2. 准备：每个节点接收并验证在准备前阶段从`领导者`接收的状态，并将其决定作为准备消息广播到分片中的其余节点。
3. 提交：在从绝大多数（2/3）节点接收到有效准备消息时，它向所有其他节点广播提交消息。一旦从绝大多数收到提交消息，该节点就会记录新状态。

在下一节中，我们将介绍不同类型的区块，以及DS委员会如何协调区块链的最终状态。



# 区块类型

由于其分片架构，Zilliqa生产了许多不同类型的区块：

1. DS Block：关于DS委员会组成的元数据，以及整个网络的状态。 DS区块之间的时间称为DS时期。 每100个事务块（Tx块）就会“挖掘”DS区块。
2. 交易区块：类似于以太坊/区块链中的区块。这些区块只是在给定时间窗口内由每个分片处理的交易的聚合。Tx区块之间的时间称为Tx Epoch。
3. 微区块：这些是碎片级交易区块。它们包含由分片处理的给定Tx Epoch的所有交易。它们由DS委员会汇总，形成一个Tx区块。

对于大多数开发人员来说，最相关的区块类型是Tx块。通常您可以使用它们来跟踪您感兴趣的交易，并检测您的交易是否已成功确认。



# 密码原函数

与所有其他区块链一样，Zilliqa依赖于许多成熟的加密原函数作为其基础构建区块。

**SHA256**

与以太坊不同，Zilliqa使用SHA256生成所有哈希值（地址、区块哈希等）。请注意，这意味着Zilliqa和以太坊地址不兼容。

**SCHNORR**

Zilliqa使用secp256k1，这是一种广泛实现且易于理解的椭圆曲线，用于使用Schnorr算法进行签名。Schnorr方案完全不同，与以太坊使用的ECDSA不相容。

**地址生成**

派生Zilliqa地址需要执行以下步骤：

1. 生成secp256k1私钥/公钥对
2. 从`sha256（public_key）`中取20个最右边的字节（即至少20个有效字节）。

请注意，这会产生一个20字节的地址，看起来与以太坊地址完全相同。为了解决这个困惑，我们目前实现了类似于[EIP55](https://github.com/ethereum/EIPs/blob/master/EIPS/eip-55.md)中的[校验和](https://github.com/Zilliqa/Zilliqa-JavaScript-Library/blob/dev/packages/zilliqa-js-crypto/src/util.ts#L106)。但是，我们改为使用第6位来决定是否使用大写。